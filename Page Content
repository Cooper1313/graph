<h2>Purpose of Tool</h2>
<p>Use this tool to generate accessible text descriptions for graphs. This ensures all students have equal access to course materials and content, complying with accessibility standards and promoting quality teaching. This tool creates a text description that can be used as alternative text for images, making visual information available to students using assistive technology.</p>
<p>The use cases for this tool include providing accessible content for courses, creating inclusive learning experiences, and ensuring that all students can fully participate in the learning process. For example, this tool can help avoid barriers for students using screen readers or other assistive devices, allowing them to understand the information presented in graphs and charts.</p>
<h2>Instructions</h2>
<p>Enter your Navigator Toolkit API key and upload a graph image to generate an accessible text description.</p>
<p><strong>Your API key is used only within your browser session and is not stored on our servers, ensuring its security.</strong></p>
<p>&nbsp;</p>
<form id="graph-form">
<div class="api-key-field"><label for="api-key">Navigator Toolkit API Key:</label> <input id="api-key" name="api-key" required="" type="text" /></div>
<div class="upload-image"><label for="image-upload">Upload Graph Image:</label> <input id="image-upload" accept="image/*" name="image-upload" required="" type="file" /></div>
<button type="submit">Convert Graph</button></form>
<div id="output">
<h2>Graph Description:</h2>
<textarea id="graph-description" style="width: 700px; height: 58px;" cols="70" readonly="readonly" rows="4"></textarea> <button id="copyButton">Copy</button></div>
<h2>Resources</h2>
<p>For more information on creating accessible content, please visit:</p>
<ul>
<li><a href="https://citt.it.ufl.edu/resources/course-development/accessible-course-design/accessibility-in-stem-courses/">CITT: Accessibility in STEM Courses</a></li>
<li><a href="https://citt.it.ufl.edu/resources/course-development/">CITT: Course Development Resources</a></li>
<li><a href="https://it.ufl.edu/ai/">UFIT AI Resources</a></li>
</ul>
<p>
<script>
        const form = document.getElementById('graph-form');
        const apiKeyInput = document.getElementById('api-key');
        const imageUploadInput = document.getElementById('image-upload');
        const graphDescriptionTextarea = document.getElementById('graph-description');
        const copyButton = document.getElementById('copyButton');

        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            const apiKey = apiKeyInput.value;
            const imageFile = imageUploadInput.files[0];

            if (!apiKey || !imageFile) {
                alert('Please enter an API key and upload an image.');
                return;
            }

            // Check if the file is an image (PNG, JPG, JPEG, GIF)
            if (!imageFile.type.startsWith('image/')) {
                alert('Please upload a valid image file (PNG, JPG, JPEG, GIF).');
                return;
            }

            const reader = new FileReader();

            reader.onload = async function(e) {
                const imageData = e.target.result; // Base64 encoded image data

                const prompt = `Describe the following graph in a way that is accessible to people using screen readers. Provide a concise and informative alt text description.  The graph is represented as a base64 encoded image: ${imageData}`;

                try {
                    const response = await fetch('https://api.ai.it.ufl.edu/v1/chat/completions', { // **CORRECTED BASE URL**
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: 'gpt-3.5-turbo',
                            messages: [{ 'role': 'user', 'content': prompt }]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const data = await response.json();
                    graphDescriptionTextarea.value = data.choices[0].message.content;
                } catch (error) {
                    console.error('Error calling OpenAI:', error);
                    graphDescriptionTextarea.value = 'Error processing the image: ' + error.message;
                }
            };

            reader.readAsDataURL(imageFile); // Read the image file as a data URL (Base64)
        });

        copyButton.addEventListener('click', function() {
            graphDescriptionTextarea.select();
            document.execCommand('copy');
            alert('Alt text copied to clipboard!');
        });
    </script>
</p>
